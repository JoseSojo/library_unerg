<?php

namespace App\Traits\Core;

use Symfony\Component\Security\Core\Exception\AccessDeniedException;

/**
 * Trait con opciones de seguridad
 *
 * @author MÃ¡ximo Sojo <maxsojo13@gmail.com>
 */
trait SecurityTrait
{
    /**
     * Returns an AccessDeniedException.
     *
     * This will result in a 403 response code. Usage example:
     *
     *     throw $this->createAccessDeniedException('Unable to access this page!');
     *
     * @throws \LogicException If the Security component is not available
     */
    protected function createAccessDeniedException(string $message = 'Access Denied.', \Throwable $previous = null): AccessDeniedException
    {
        if (!class_exists(AccessDeniedException::class)) {
            throw new \LogicException('You cannot use the "createAccessDeniedException" method if the Security component is not available. Try running "composer require symfony/security-bundle".');
        }

        return new AccessDeniedException($message, $previous);
    }
}
